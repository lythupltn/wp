!function r(l,c,a){function d(t,e){if(!c[t]){if(!l[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(s)return s(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var o=c[t]={exports:{}};l[t][0].call(o.exports,function(e){return d(l[t][1][e]||e)},o,o.exports,r,l,c,a)}return c[t].exports}for(var s="function"==typeof require&&require,e=0;e<a.length;e++)d(a[e]);return d}({1:[function(e,t,n){"use strict";var i,o=e("./view.new"),c=(i=o)&&i.__esModule?i:{default:i};!function(s){var t=void 0,w=void 0;s.bind("ready",function(){s.previewer.bind("ready",function(e){s.previewer.send("lwwb_config",_lwwbConfig),t=$("#customize-preview iframe").get($("#customize-preview iframe").length-1).contentWindow,s.section("lwwb_section").expand(!0),new c.default({el:"#lwwb-control-container",radioChannel:t.lwwb.Radio.channel}).render()}),w={current_page:[],elmn_picker:[],elmn:[],global_setting:[]},s.previewer.bind("preview_data",function(e){o(e),r(e),l(e)}),e(),s.previewer.bind("active_group_control",function(e){s.control("setting_switcher").container.find('.lwwb-input[value="'+e+'"]').trigger("click")})});var e=function(){s.control("setting_switcher").container.on("click",".lwwb-input",function(e){var t=$(e.currentTarget).val();n(t)})},n=function(e){var t=_.clone(w);delete t[e],_.each(t,function(e,t){i(e)}),_.each(w[e],function(e,t){e.active()||e.active(!0)})},i=function(e){_.each(e,function(e){e.active(!1)})},o=function(n){var e=s.Setting.extend({}),t="lwwb_data["+n.page.id+"][data]",i=s(t);if(!i){i=new e(t,void 0,{transport:"postMessage",previewer:s.previewer,dirty:!0}),s.add(t,i)}var o=s.control("lwwb_build_panel");o&&!w.elmn.length&&w.elmn.push(o),s.previewer.bind("collection_data"+n.page.id,function(e){var t={header:n.header.id,footer:n.footer.id,content:e};i.set(JSON.stringify(t))})},r=function(e){var t=s.Setting.extend({}),n="lwwb_data["+e.page.id+"][header]",i="lwwb_data["+e.page.id+"][footer]",o="lwwb_data["+e.page.id+"][hooks]",r=s(n),l=s(i),c=s(o);if(r||(r=new t(n,e.header.id,{transport:"refresh",default:"",previewer:wp.customize.previewer}),s.add(n,r)),s.control(n))u()&&s.control(n).active(!0);else{var a=new s.Control(n,{section:"lwwb_section",label:"Header Config",type:"select",setting:n,priority:12,choices:_lwwb_tmplCustomize.header,active:!1});s.control.add(a),-1==_.indexOf(w.current_page,a)&&w.current_page.push(a)}if(l||(l=new t(i,e.footer.id,{transport:"refresh",default:"",previewer:s.previewer}),s.add(i,l)),s.control(i))u()&&s.control(i).active(!0);else{a=new s.Control(i,{section:"lwwb_section",label:"Footer Config",type:"select",setting:i,priority:12,choices:_lwwb_tmplCustomize.footer,active:!1});s.control.add(a),-1==_.indexOf(w.current_page,a)&&w.current_page.push(a)}if(c||(c=new t(o,e.hooks,{transport:"refresh",default:e.hooks,multi:!0,previewer:s.previewer}),s.add(o,c)),s.control(o))u()&&s.control(o).active(!0);else{var d=new s.controlConstructor["lwwb-checkbox"](o,{section:"lwwb_section",label:"Hide Hooks Builder",type:"lwwb-checkbox",settings:{default:o},value:e.hooks,priority:12,choices:_lwwb_tmplCustomize.hooks,active:!1});s.control.add(d),-1==_.indexOf(w.current_page,d)&&w.current_page.push(d)}},u=function(){return s.control("setting_switcher").container.find('.lwwb-input[value="current_page"]').prop("checked")},l=function(e){u()?i(w.elmn_picker):w.elmn_picker.length||_.each(e.config.elmnGroups,function(e,t){s.control(t)&&w.elmn_picker.push(s.control(t))})}}(wp.customize)},{"./view.new":2}],2:[function(e,t,n){"use strict";function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g},r=Marionette.Behavior.extend({onRender:function(){var i=this;this.view.$el.find(".customize-control-group").first().show(),this.view.$el.find(".widget-inside").first().show(),this.view.$el.find("input#lwwb_search_control").on("keyup search change",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).val().trim().toLowerCase();if(t){var n=i.view.$el.find('.lwwb-control-container[data-keywords*="'+t+'"]');i.view.$el.find(".lwwb-control-container").not("#customize-control-lwwb-text-lwwb_search_control").hide(),i.view.$el.find(".customize-control-group").hide(),n.show(),n.parents(".customize-control-group").show(),n.parents(".widget-inside").show()}else i.view.$el.find(".lwwb-control-container").show(),i.view.render(),i.view.$el.find("input#lwwb_search_control").focus()})}}),l=Marionette.View.extend({template:_.template('<div class="lwwb-control-container"></div>',i),regions:{listControl:{el:".lwwb-control-container",replaceElement:!0}},behaviors:[r],modelEvents:{"change:elmn_data:contenteditable":"renderEditableContent","change:elmn_data:field":"updateElmnDataAndOptions"},childViewTriggers:{"list:control:update:data":"child:list:control:update:data"},initialize:function(){var e=this.model.get("elmn_type"),t=this.model.get("elmn_data");if(_lwwbConfig.elmns[e]){var n=JSON.parse(JSON.stringify(_lwwbConfig.elmns[e].controls)),i=_.map(n,function(n){"lwwb-group"!==n.type&&"lwwb-repeater"!==n.type||_.map(n.fields,function(i){var n=void 0;return _.each(t,function(e,t){t===i.id&&(n=o({},t,e))}),i.value=n?n[i.id]:i.default,i.fields&&_.each(i.value,function(e,n){var t=_.find(i.fields,function(e,t){return e.id===n});t&&(t.value=e)}),i});var i=void 0;return _.each(t,function(e,t){t===n.id&&(i=o({},t,e))}),n.value=i?i[n.id]:n.default,n});this.collection=new Backbone.Collection(i)}},renderEditableContent:function(n,i){_.each(this.getRegion("listControl").currentView.children._views,function(e){if(e.getRegion("controlRegion")){var t=_.find(e.getRegion("controlRegion").currentView.children._views,function(e){return e.model.get("id")===n});t&&(t.model.set("value",i),t.render())}})},updateElmnDataAndOptions:function(t,i,o){_.each(this.getRegion("listControl").currentView.children._views,function(e){if(e.getRegion("controlRegion")){var n=_.find(e.getRegion("controlRegion").currentView.children._views,function(e){return e.model.get("id")===t});n&&(n.model.set("value",i).trigger("change:value"),o&&_.each(o,function(e,t){n.triggerMethod("update:option:"+t.replace(/-/g,":").replace(/_/g,":"),e)}),o&&o.input_attrs&&n.model.set("input_attrs",o.input_attrs),o&&o.unit&&n.model.set("unit",o.unit),n.render())}})},onRender:function(){var e=new lwwb.Control.Mn.Views["control-collection"]({collection:this.collection});this.showChildView("listControl",e)},onChildListControlUpdateData:function(e,t){var n=e.model.get("id"),i=this.model.get("elmn_data");this.model.set("elmn_data",_.extend(i,o({},n,t))),this.model.trigger("change:elmn_data",n,t,e)}}),c=Marionette.View.extend({initialize:function(e){this.radioChannel=e.radioChannel,this.cacheElmn=[]},template:_.template('<div class="lwwb-control-container"></div>',i),regions:{elmnRegion:{el:".lwwb-control-container",replaceElement:!0}},onRender:function(){var t=this;this.listenTo(this.radioChannel,"active:elmn:control",function(e){t.activeApiControl(),t.showElmnView(e)})},activeApiControl:function(){wp.customize.section("lwwb_section").expanded()||wp.customize.section("lwwb_section").expanded(!0),wp.customize.control("lwwb_build_panel").active()||wp.customize.control("lwwb_build_panel").active(!0),wp.customize.control("setting_switcher").container.find('input[value="elmn"]').trigger("click")},showElmnView:function(e){if(!this.maybeShowCache(e)){var t=new l({model:e});this.getRegion("elmnRegion").detachView(),this.showChildView("elmnRegion",t),this.cacheElmn.push({mcid:e.cid,elmn:e,view:t})}},maybeShowCache:function(t){var e=_.find(this.cacheElmn,function(e){return e.mcid===t.cid});if(e){var n=this.getRegion("elmnRegion");return!(!n.currentView||n.currentView.model.cid!==e.mcid)||!e.view.$el.find(".lwwb-control-lwwb-wysiwyg").length&&(this.getRegion("elmnRegion").detachView(),this.showChildView("elmnRegion",e.view),!0)}return!1}});t.exports=c},{}]},{},[1]);
//# sourceMappingURL=builder-control.min.js.map
